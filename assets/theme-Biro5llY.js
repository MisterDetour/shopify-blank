document.querySelectorAll('form[action="/cart/add"]').forEach(t=>{t.addEventListener("submit",async e=>{e.preventDefault(),document.querySelector(".cart-drawer").classList.add("active"),await fetch("/cart/add",{method:"post",body:new FormData(t)});const r=await(await fetch("/cart.js")).json();o(r.item_count),await n()})});document.querySelectorAll(".cart-link").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),document.querySelector(".cart-drawer").classList.add("active")})});document.querySelectorAll(".cart-drawer-close").forEach(t=>{t.addEventListener("click",()=>{document.querySelector(".cart-drawer").classList.remove("active")})});async function n(){const e=await(await fetch("/?section_id=cart-drawer")).text(),r=new DOMParser().parseFromString(e,"text/html").querySelector(".cart-drawer .cart-items"),a=document.querySelector(".cart-drawer .cart-items");a.parentNode.replaceChild(r,a)}async function i(){const e=await(await fetch("/?section_id=main-cart")).text(),r=new DOMParser().parseFromString(e,"text/html").querySelector(".cart-table .cart-items"),a=document.querySelector(".cart-table .cart-items");a.parentNode.replaceChild(r,a)}function o(t){document.querySelectorAll(".cart-item-count").forEach(e=>{e.textContent=t})}document.body.addEventListener("click",async t=>{if(!t.target.matches(".btn-quantity"))return;const e=t.target;t.preventDefault();const c=e.closest(".cart-item"),r=c.getAttribute("data-key");let a=c.querySelector(".quantity-input").value;e.classList.contains("btn-plus")?a++:a--,c.querySelector(".quantity-input").value=a;const s=await(await fetch("/cart/update.js",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({updates:{[r]:a}})})).json();n(),i(),o(s.item_count)});
